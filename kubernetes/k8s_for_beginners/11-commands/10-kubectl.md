# kubectl
kubectl - это основной инструмент для работы с Kubernetes.

Подробная [инструкция](https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/) по установке.

Краткая [инструкция](./00-kubectl-install.md) по установке на Linux.

Есть несколько приложений с графическим интерфейсом, которые позволяют работать с Kubernetes.
Такого рода приложения рекомендую использовать в самом начале знакомства с Kubernetes.
Можно использовать их и профессионалам, но графический интерфейс не позволяет автоматизировать рутинные операции.
Для этого хорошо подходит `kubectl`.

## kubectl get
Получение списка ресурсов определённого типа 

Полезные флаги:
- --all-namespaces — выводит ресурс из всех NS;
- --selector — применяется для фильтрации;
- --output — вывод описания объекта.

## kubectl describe

Получение детальной информации об объекте в кластереПолезные флаги:
- --show-events — можно скрыть список событий

## kubectl exec
Выполнение команды в контейнере отдельного пода

Полезные флаги:
- -с, --container — выбор отдельного контейнера в поде;
- -t, --tty — направляет ввод через терминал;
- -i, --stdin — позволяет направить stdin в контейнер

## kubectl edit
Изменение ресурса напрямую в кластере. Вызовет системный консольный редактор Полезные флаги:
- --validate — позволяет отключить проверку конфига

## kubectl logs
Получение логов от ресурса или конкретного контейнера в подеПолезные флаги:
- --all-containers — получение логов от всех контейнеров в поде сразу;
- -f, --follow — позволяет следить за логами в реальном времени;
- -p лог от предыдущего запуска.

## kubectl apply
kubectl apply / delete
Создание и удаление ресурсов. Обычно применяются с файлами Полезные флаги:
- -f — указывается файл с ресурсами для применения;
- --grace-period — можно задать таймаут для действия

## kubectl delete

## kubectl cordon / uncordon
Служит для исключения ноды из планирования и возврата в обычный режим.
Когда нода исключена из планирования, то новые поды не распределяются на такую ноду. 
Те поды, которые уже запущены на этой ноде, продолжают работать.
 
## kubectl drain
Полезные флаги:
- --delete-local-data — удаляет локальные данные.

## kubectl taint
Служит для установки, обновления и удаления taint на ноде. Taint нужен для подсказки kube-scheduler как распределять поды.

Taint в переводе это что-то вроде примеси. Поды могут быть толерантны к таким примесям, или же не толерантны.

```shell script
# Удалить taint с ноды для возможности запуска рабочей нагрузки на control plane node  
kubectl taint node master1 node-role.kubernetes.io/master-
```

## kubectl port-forward
Обеспечивает доступ к ресурсу кластера с компьютера, на котором запущена эта команда.

Полезные флаги:
- --address — можно указать, какой адрес должен слушать локально.

## kubectl label / annotate
Управление метками и аннотациями объектов. 

Полезные флаги:
- --list — вместо изменения выводит список текущих меток/аннотаций для ресурса

## kubectl config
Управление локальным конфиг-файлом

Полезные команды:
- current-context — получение текущего кластера/пользователя для команд;
- get-contexts — вывод списка доступных контекстов;
- use-context — изменение текущего контекста на указанный

## kubectl create
Создание объектов.

Полезные флаги:
- --namespace пространство имен, в котором нужно создать объект;

### Демо
```shell script
kubectl create deployment nginx --namespace default --image=nginx:latest --replicas=2
kubectl create deployment mt --namespace default --image=praqma/network-multitool:alpine-extra --replicas=2
```
